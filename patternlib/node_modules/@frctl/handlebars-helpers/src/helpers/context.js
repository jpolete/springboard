'use strict';

const Handlebars = require('handlebars');

module.exports = function(fractal){

    return function context(handle){
        const source    = fractal.components;
        const component = source.find(handle);
        if (!component) {
            fractal.console.error(`[context-helper] Component ${handle} not found.`);
            return Promise.resolve('');
        }
        const context = component.type === 'component' ? component.variants().default().context : component.context;
        return source.resolve(context).then(ctx => new Handlebars.SafeString(JSON.stringify(ctx, null, 4)));
    };

};
